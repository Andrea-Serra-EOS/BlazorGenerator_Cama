@inherits LayoutComponentBase

<Layout Sider>
    <LayoutSider>
        <LayoutSiderContent>
            <NavMenu />
        </LayoutSiderContent>
    </LayoutSider>
    <Layout>
        <LayoutContent Style="padding: 0px 10px !important;">
            <CascadingValue Value="@this">
                <ErrorBoundary @ref="errorBoundary">
                    <ErrorContent>
                        <DynamicErrorHandler errorBoundary="errorBoundary" />
                    </ErrorContent>
                    <ChildContent>
                        @Body
                    </ChildContent>
                </ErrorBoundary>

            </CascadingValue>
            <ModalProvider Size="ModalSize.Large" UseModalStructure=true />
        </LayoutContent>
        <LayoutFooter Fixed=true Display="GetLogDisplay()" Visibility="GetLogVisibility()">
            <Log></Log>
        </LayoutFooter>
    </Layout>
</Layout>

<PageProgressProvider />
<MessageProvider />
<Choose @ref="ChooseService" />
<NotificationProvider Style="z-index:99999999 !important;" />


<style>
    .fa, .fas {
        color: #1e88e5;
    }
</style>


@code {

    [Inject] protected BlazorGenOptions Options { get; set; }

    private Theme theme { get; set; }

    public Choose ChooseService { get; set; }

    private bool showLog = false;

    ErrorBoundary errorBoundary;

    private Visibility GetLogVisibility()
    {
        return showLog ? Visibility.Visible : Visibility.Invisible;
    }

    private IFluentDisplay GetLogDisplay()
    {
        return showLog ? Display.Always : Display.None;
    }

    private IFluentSizing GetContentHeight()
    {
        return showLog ? Height.Is75 : Height.Auto;
    }
    private IFluentSizing GetFooterHeight()
    {
        return showLog ? Height.Is25 : Height.Auto;
    }


    public void setLogVisibility(bool show)
    {
        showLog = show;
        StateHasChanged();
    }


    protected override void OnParametersSet()
    {
        showLog = false;
        errorBoundary?.Recover();

    }
}