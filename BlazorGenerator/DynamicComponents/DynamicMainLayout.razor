@inherits LayoutComponentBase

<FluentDesignTheme OfficeColor="@(BlazorGeneratorSettings.Instance.BaseColor)" @ref="Theme" StorageName="UITheme">
  <FluentLayout>
    <FluentHeader>
      <Back></Back>
      <FluentSpacer />
      @BlazorGeneratorSettings.Instance.ApplicationName
      <FluentSpacer />
      <div style="padding-right: 6px; margin-left: 0; margin-right: 25px;">
        <FluentButton BackgroundColor="var(--neutral-fill-stealth-rest)" OnClick="SwitchDarkLightTheme" Title="Toggle Dark Theme">
          <FluentIcon Value="@(new Icons.Regular.Size20.DarkTheme())" Color="Color.Neutral" Title="Toggle Dark Theme" />
        </FluentButton>
        <Log />
      </div>
    </FluentHeader>
    <FluentStack Class="main" Orientation="Orientation.Horizontal" Width="100%" VerticalGap="0" HorizontalGap="0">
      <NavMenu />
      <FluentBodyContent>
        <FluentLayout>
          <FluentBodyContent style="height: calc(100dvh); padding: 10px; ">
            <Progress></Progress>
            <div class="content" style="display: flex; flex-direction: column; height: 100%; flex-flow: column;">
              @Body
            </div>

            <FluentDialogProvider />
            <FluentKeyCodeProvider />
          </FluentBodyContent>

        </FluentLayout>

      </FluentBodyContent>
    </FluentStack>
  </FluentLayout>

</FluentDesignTheme>

@code{
  FluentDesignTheme? Theme { get; set; }

  [Inject]
  public UIServices? UIServices { get; set; }
  [Inject]
  public IDialogService? DialogService { get; set; }
  [Inject]
  public ProgressService? ProgressService { get; set; }
  [Inject]
  public IKeyCodeService? KeyCodeService { get; set; }

  private void SwitchDarkLightTheme()
  {
    Theme!.Mode = Theme.Mode == DesignThemeModes.Light ? DesignThemeModes.Dark : DesignThemeModes.Light;

  }

  protected override Task OnParametersSetAsync()
  {
    UIServices!.DialogService = DialogService!;
    UIServices!.ProgressService = ProgressService!;
    UIServices.KeyCodeService = KeyCodeService!;
    return base.OnParametersSetAsync();
  }
}
