@{
    var PageActions = AttributesUtils.GetMethodsWithAttribute<PageActionAttribute>(this);
    var BasicActions = AttributesUtils.GetModelsWithAttribute<BasicActionsAttribute>(this).FirstOrDefault() ?? new BasicActionsAttribute(false, false, false);
}
@typeparam T
@typeparam TList
@inherits BlazorgenBaseComponent


<Layout>

    <LayoutHeader Fixed="true">
        <ActionBar PageActions="@PageActions" Context="this"></ActionBar>
    </LayoutHeader>
    <LayoutContent Height="Height.Is75">
        <Card Margin="Margin.Is4.FromBottom">
            <CardBody>
                <Row>
                    @foreach (var fld in VisibleFields)
                    {
                        <Column ColumnSize="@fld.ColumnSize">
                            <Field Horizontal="true">
                                <FieldLabel>@(fld.Caption): </FieldLabel>
                                <FieldBody>
                                    @switch (fld.FieldType)
                                    {
                                        case BlazorGenerator.Enum.FieldType.Numeric:
                                            <BlazorGenerator.Pages.Partials.Numeric T="T" Data="Data" Field="fld" />
                                            break;
                                        case BlazorGenerator.Enum.FieldType.Boolean:
                                            <BlazorGenerator.Pages.Partials.Checkbox T="T" Data="Data" Field="fld" />
                                            break;
                                        case BlazorGenerator.Enum.FieldType.Select:
                                            <BlazorGenerator.Pages.Partials.Dropdown T="T" Data="Data" Field="fld" />
                                            break;
                                        case BlazorGenerator.Enum.FieldType.Button:
                                            <BlazorGenerator.Pages.Partials.Btn T="T" Data="Data" Field="fld" />
                                            break;
                                        case BlazorGenerator.Enum.FieldType.Custom:
                                            <BlazorGenerator.Pages.Partials.Custom T="T" Data="Data" Field="fld" />
                                            break;
                                        default:
                                            <BlazorGenerator.Pages.Partials.Txt T="T" Data="Data" Field="fld" />
                                            break;
                                    }
                                </FieldBody>
                            </Field>
                        </Column>
                    }
                </Row>
            </CardBody>
        </Card>

        <DataGrid TItem="TList"
                  @ref="@_datagrid"
                  Data="@ListData"
                  SelectionMode="DataGridSelectionMode.Multiple"
                  SelectedRows="@SelectedRecs"
                  Resizable="true"
                  ShowPager="false"
                  ShowPageSizes="false"
                  PageSize="int.MaxValue"
                  Filterable="true"
                  Responsive="true"
                  Narrow="true"
                  FixedHeader="true"
                  FixedHeaderDataGridHeight="75vh"
                  FixedHeaderDataGridMaxHeight="75vh"
                  Editable
                  EditMode="@GetEditMode()"
                  NewItemCreator="@CreateNewItem"
                  RowInserted="@OnInsert"
                  RowRemoved="@OnDelete"
                  RowUpdated="@OnModify"
                  RowStyling="@RowStyling"                  
                  HeaderThemeContrast="ThemeContrast.Light"
                  CommandMode="DataGridCommandMode.Commands">

            <DataGridColumns > 
                <DataGridMultiSelectColumn TItem="TList" Width="30px"></DataGridMultiSelectColumn>
                <DataGridCommandColumn Width="150px" TItem="TList" NewCommandAllowed="BasicActions.NewAction" EditCommandAllowed="BasicActions.EditAction" DeleteCommandAllowed="BasicActions.DeleteAction">
                    <NewCommandTemplate>
                        <Button Size="Size.ExtraSmall" Color="Color.Dark" Margin="Margin.Is1" Outline="true" Clicked="@context.Clicked"><Icon Name="IconName.Add"></Icon>&nbsp;@context.LocalizationString</Button>
                    </NewCommandTemplate>
                    <EditCommandTemplate>
                        <Button Size="Size.ExtraSmall" Color="Color.Dark" Margin="Margin.Is1" Outline="true" Clicked="@context.Clicked"><Icon Name="IconName.Edit"></Icon>&nbsp;@context.LocalizationString</Button>
                    </EditCommandTemplate>
                    <SaveCommandTemplate>
                        <Button Size="Size.ExtraSmall" Color="Color.Dark" Margin="Margin.Is1" Outline="true" PreventDefaultOnSubmit Clicked="@context.Clicked">@context.LocalizationString</Button>
                    </SaveCommandTemplate>
                    <DeleteCommandTemplate>
                        <Button Size="Size.ExtraSmall" Color="Color.Dark" Margin="Margin.Is1" Outline="true" Clicked="@context.Clicked"><Icon Name="IconName.Delete"></Icon>&nbsp;@context.LocalizationString</Button>
                    </DeleteCommandTemplate>
                    <CancelCommandTemplate>
                        <Button Size="Size.ExtraSmall" Color="Color.Dark" Margin="Margin.Is1" Outline="true" Clicked="@context.Clicked">@context.LocalizationString</Button>
                    </CancelCommandTemplate>
                    <ClearFilterCommandTemplate>
                        <Button Size="Size.ExtraSmall" Color="Color.Dark" Margin="Margin.Is1" Outline="true" Clicked="@context.Clicked"><Icon Name="IconName.Clear"></Icon>&nbsp;@context.LocalizationString</Button>
                    </ClearFilterCommandTemplate>
                </DataGridCommandColumn>
                @foreach (var fld in ListVisibleFields)
                {
                    switch (fld.FieldType)
                    {
                        case BlazorGenerator.Enum.FieldType.Numeric:
                            <BlazorGenerator.Pages.Partials.DataGridNumeric T="TList" Field="fld" Order="@(ListVisibleFields.IndexOf(fld))" />
                            break;
                        case BlazorGenerator.Enum.FieldType.Boolean:
                            <BlazorGenerator.Pages.Partials.DataGridCheckbox T="TList" Field="fld" Order="@(ListVisibleFields.IndexOf(fld))" />
                            break;
                        case BlazorGenerator.Enum.FieldType.Custom:
                            <BlazorGenerator.Pages.Partials.DataGridCustom T="TList" Field="fld" Order="@(ListVisibleFields.IndexOf(fld))" />
                            break;
                        case BlazorGenerator.Enum.FieldType.Select:
                            <BlazorGenerator.Pages.Partials.DataGridDropdown T="TList" Field="fld" Order="@(ListVisibleFields.IndexOf(fld))" />
                            break;
                        case BlazorGenerator.Enum.FieldType.Button:
                            break;

                        case BlazorGenerator.Enum.FieldType.Icon:
                            <BlazorGenerator.Pages.Partials.DataGridIcon T="TList" Field="fld" Order="@(ListVisibleFields.IndexOf(fld))" />
                            break;

                        default:
                            <DataGridColumn TItem="TList"
                                Field="@fld.Name"
                                Caption="@fld.Caption"
                                Sortable="true"                                 
                                SortDirection="@fld.Sort"
                                Filterable="true" Editable="true" Displayable="@(!fld.EditOnly)" DisplayOrder="@(ListVisibleFields.IndexOf(fld))" Width="@fld.Width" />
                            break;
                    }
                }
            </DataGridColumns>

        </DataGrid>
    </LayoutContent>

</Layout>